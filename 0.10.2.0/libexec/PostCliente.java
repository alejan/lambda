
//import util.properties packages
import java.util.Properties;

//import simple producer packages
import org.apache.kafka.clients.producer.Producer;

//import KafkaProducer packages
import org.apache.kafka.clients.producer.KafkaProducer;

//import ProducerRecord packages
import org.apache.kafka.clients.producer.ProducerRecord;

//Create java class named SimpleProducer

import java.util.Random;


public class PostCliente {

   public static void main(String[] args) throws Exception{
      // Check arguments length value
      if(args.length == 0){
         System.out.println("Enter topic name");
         return;
      }


String[][] ubicacion={{"00-0","4.678496643716877","-74.07829481595651"},
{"00-1","4.561383203074723","-74.15132568473086"},
{"00-2","4.593733549021873","-74.11726505905634"},
{"00-3","4.683061396012669","-74.13293980493451"},
{"00-4","4.561038925510342","-74.107038936024"},
{"00-5","4.675494739004833","-74.12092386365383"},
{"00-6","4.686843704367104","-74.05345382759107"},
{"00-7","4.56987032072677","-74.05347630586695"},
{"00-8","4.591389018634298","-74.16302861787831"},
{"00-9","4.6654491740763095","-74.10779380212816"},
{"00-10","4.614207982990985","-74.1408286136029"},
{"00-11","4.679352123399475","-74.09027149194253"},
{"00-12","4.5892907205822695","-74.14863726725777"},
{"00-13","4.653465590739137","-74.0718503016028"},
{"00-14","4.675819144333476","-74.08371294486871"},
{"00-15","4.626898484352682","-74.10720011022805"},
{"00-16","4.631381236529341","-74.05174245857285"},
{"00-17","4.659679407754971","-74.04808207079037"},
{"00-18","4.680224726420009","-74.1504071048683"},
{"00-19","4.602037526171144","-74.09554142593856"},
{"00-20","4.616460715993738","-74.09624156852178"},
{"00-21","4.564381011197297","-74.12018179957563"},
{"00-22","4.687506058570198","-74.15489919303968"},
{"00-23","4.596942303124986","-74.16224513685721"},
{"00-24","4.641078449423352","-74.05945081619406"},
{"00-25","4.577612344068298","-74.1007382040618"},
{"00-26","4.627182697459964","-74.14987072277337"},
{"00-27","4.578177636369638","-74.10975888924938"},
{"00-28","4.62428002548381","-74.1601920305535"},
{"00-29","4.663185057643341","-74.10000142988515"},
{"00-30","4.6655592311751635","-74.09888127679835"},
{"00-31","4.591223565411308","-74.15523508582136"},
{"00-32","4.677944076740379","-74.09773597186147"},
{"00-33","4.6847861408523865","-74.15098983742021"},
{"00-34","4.679165667940699","-74.15602732028664"},
{"00-35","4.6092449426949","-74.15211120810622"},
{"00-36","4.595798423328668","-74.108631534037"},
{"00-37","4.576043163143224","-74.13147850106029"},
{"00-38","4.643053861021931","-74.05006872359888"},
{"00-39","4.627998927105223","-74.09099029585873"},
{"00-40","4.680843706053154","-74.0948286135235"},
{"00-41","4.658352536357823","-74.08209449765242"},
{"00-42","4.619373661986909","-74.07925309935814"},
{"00-43","4.621086417935673","-74.12075084683336"},
{"00-44","4.640411813609373","-74.0463050248597"},
{"00-45","4.685043435965843","-74.11254432760992"},
{"00-46","4.642637790079524","-74.04825846129503"},
{"00-47","4.6601756704179556","-74.11594976818922"},
{"00-48","4.675467731622116","-74.09423620927788"},
{"00-49","4.563124248973617","-74.0537274522053"},
{"00-50","4.567943606952652","-74.11670934356525"},
{"00-51","4.617140649064314","-74.13348462458066"},
{"00-52","4.638573611336724","-74.08176513135363"},
{"00-53","4.607884740783043","-74.09627641179576"},
{"00-54","4.63884224433882","-74.06627390804172"},
{"00-55","4.607550837379998","-74.08723783946974"},
{"00-56","4.663824135685082","-74.09044812311238"},
{"00-57","4.665103309298551","-74.05653042388586"},
{"00-58","4.671224816039671","-74.07786212508172"},
{"00-59","4.606137586652535","-74.15925607117147"},
{"00-60","4.655525554049792","-74.11209304009174"},
{"00-61","4.624701962706897","-74.09076596153712"},
{"00-62","4.648305652993389","-74.05269358405194"},
{"00-63","4.59093721551682","-74.10060046290317"},
{"00-64","4.658082935033395","-74.12847851056851"},
{"00-65","4.674280933319767","-74.08898820318011"},
{"00-66","4.68882676634625","-74.15905203742685"},
{"00-67","4.63305340870894","-74.05247191596051"},
{"00-68","4.611694456625742","-74.1348376346003"},
{"00-69","4.594405060964532","-74.15940383776802"},
{"00-70","4.61913801158113","-74.04819820421832"},
{"00-71","4.644876696274844","-74.1628121524469"},
{"00-72","4.661508854603113","-74.14048594112694"},
{"00-73","4.5866073475351055","-74.07869815382954"},
{"00-74","4.596265655689664","-74.06507693219109"},
{"00-75","4.584547994039315","-74.04870170185264"},
{"00-76","4.590599351491678","-74.0921798891378"},
{"00-77","4.63457432304697","-74.06070785536909"},
{"00-78","4.579707288106875","-74.08289129782295"},
{"00-79","4.632240505217896","-74.12060453517486"},
{"00-80","4.662236613442472","-74.04623081098147"},
{"00-81","4.560706115989971","-74.07479356893029"},
{"00-82","4.559347297971171","-74.04805666235455"},
{"00-83","4.6236935080690795","-74.14146754279733"},
{"00-84","4.666442605361612","-74.1252575201569"},
{"00-85","4.605959381060581","-74.12503246645564"},
{"00-86","4.586566386843249","-74.14723833527609"},
{"00-87","4.689488769700453","-74.13876154057452"},
{"00-88","4.57413442593657","-74.05884149648922"},
{"00-89","4.684141460410316","-74.06770194819887"},
{"00-90","4.609058785556795","-74.05919483132605"},
{"00-91","4.610131615825218","-74.1545230099326"},
{"00-92","4.580157415496544","-74.12659889632154"},
{"00-93","4.57148045402784","-74.14906585480252"},
{"00-94","4.668784172749247","-74.06103735577878"},
{"00-95","4.558726968109542","-74.1470982416052"},
{"00-96","4.585037172237801","-74.08383826137917"},
{"00-97","4.5634840528555936","-74.0800571240162"},
{"00-98","4.608759476483176","-74.11547455206383"},
{"00-99","4.675557783864731","-74.09991814201764"}};



      String[] referencia={"queso","pan","leche","huevos","salchicha"};
      String[] cantidad={"10","20","30","40","50","60","70","80","90","100"};
      Random randomGenerator = new Random();
      int i=0;
      //Assign topicName to string variable
      String topicName = args[0].toString();
      // create instance for properties to access producer config
      Properties props = new Properties();
      //Assign localhost id
      props.put("bootstrap.servers", "localhost:9092");
      //Set acknowledgements for producer requests.
      props.put("acks", "all");

      //If the request fails, the producer can automatically retry,
      props.put("retries", 0);

      //Specify buffer size in config
      props.put("batch.size", 16384);
      //Reduce the no of requests less than 0
      props.put("linger.ms", 1);
      //The buffer.memory controls the total amount of memory available to the producer for buffering
      props.put("buffer.memory", 33554432);
      props.put("key.serializer",
         "org.apache.kafka.common.serialization.StringSerializer");
      props.put("value.serializer",
         "org.apache.kafka.common.serialization.StringSerializer");

      Producer<String, String> producer = new KafkaProducer<String, String>(props);

         while(true){
          if(i==100)
	     i=0;
             String json = "00-"+i+","+ubicacion[i][1]+","+ubicacion[i][2]+","+referencia[randomGenerator.nextInt(4)]+","+cantidad[randomGenerator.nextInt(9)];
   System.out.println(json);
         producer.send(new ProducerRecord<String, String>(topicName,Integer.toString(i), json));
             i++; }// System.out.println("Message sent successfully");
             //  producer.close();
   }
}

class Cliente{

private String zona;
private String nombre;
private Producto producto;


public Cliente(String zona,String nombre, Producto producto){
this.zona=zona;
this.nombre=nombre;
this.producto=producto;

}

public void setZona(String zona){
this.zona= zona;
}

public String getZona(){
return this.zona;
}

public void setNombre(String nombre){
this.nombre=nombre;
}

public String getNombre(){
return this.nombre;
}

public void setProducto(Producto producto){
this.producto=producto;
}

public Producto getProducto(){
return this.producto;
}

}

class Producto{
private String referencia;
private String cantidad;



public Producto(String referencia, String cantidad){
this.referencia=referencia;
this.cantidad=cantidad;
}

public void setReferencia(String referencia){
this.referencia=referencia;
}
public String getReferencia(){
return this.referencia;
}
public void setCantidad(String cantidad){
this.cantidad=cantidad;
}
public String getCantidad(){
return this.cantidad;
}

}
